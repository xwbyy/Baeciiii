<%- include('partials/header') %>

<section class="py-12 px-4">
  <div class="max-w-4xl mx-auto">
    <div class="absolute top-20 left-10 w-72 h-72 bg-purple-500/20 rounded-full blur-3xl"></div>
    
    <div class="relative z-10 fade-in">
      <div class="flex items-center justify-between mb-8">
        <h1 class="text-2xl md:text-3xl font-bold">
          <i class="fas fa-shopping-bag text-pink-400 mr-3"></i>
          Pesanan Saya
        </h1>
        <a href="/profile" class="text-gray-400 hover:text-white transition">
          <i class="fas fa-arrow-left mr-2"></i>Kembali
        </a>
      </div>
      
      <% if (orders && orders.length > 0) { %>
        <div class="space-y-4">
          <% orders.forEach((order, index) => { %>
            <div class="glass-card rounded-2xl p-5 fade-in" style="animation-delay: <%= index * 0.05 %>s">
              <div class="flex items-start justify-between mb-4">
                <div class="flex items-center gap-4">
                  <div class="w-14 h-14 rounded-xl bg-gradient-to-br from-purple-500/30 to-pink-500/30 flex items-center justify-center">
                    <i class="fas <%= order.productType === 'server' ? 'fa-server' : 'fa-box' %> text-xl text-purple-400"></i>
                  </div>
                  <div>
                    <div class="font-semibold text-lg"><%= order.productName %></div>
                    <div class="text-sm text-gray-500">
                      Order ID: <%= order.id %>
                    </div>
                  </div>
                </div>
                <span class="px-3 py-1 rounded-full text-xs font-medium <%= 
                  order.status === 'completed' ? 'bg-green-500/20 text-green-400' : 
                  order.status === 'pending' ? 'bg-yellow-500/20 text-yellow-400' : 
                  'bg-red-500/20 text-red-400' %>">
                  <%= order.status === 'completed' ? 'Selesai' : order.status === 'pending' ? 'Pending' : order.status %>
                </span>
              </div>
              
              <% if (order.productType === 'server' && order.serverDetails) { 
                let details = {};
                try { details = JSON.parse(order.serverDetails); } catch(e) {}
              %>
                <div class="grid grid-cols-4 gap-2 mb-4">
                  <div class="text-center p-2 rounded-lg bg-white/5">
                    <div class="text-sm font-semibold text-purple-400"><%= details.ram || '-' %></div>
                    <div class="text-xs text-gray-500">RAM</div>
                  </div>
                  <div class="text-center p-2 rounded-lg bg-white/5">
                    <div class="text-sm font-semibold text-pink-400"><%= details.cpu || '-' %></div>
                    <div class="text-xs text-gray-500">CPU</div>
                  </div>
                  <div class="text-center p-2 rounded-lg bg-white/5">
                    <div class="text-sm font-semibold text-orange-400"><%= details.disk || '-' %></div>
                    <div class="text-xs text-gray-500">Disk</div>
                  </div>
                  <div class="text-center p-2 rounded-lg bg-white/5">
                    <div class="text-sm font-semibold text-cyan-400"><%= details.location || '-' %></div>
                    <div class="text-xs text-gray-500">Lokasi</div>
                  </div>
                </div>
                
                <% if (details.panelUsername && details.panelPassword) { %>
                <div class="glass rounded-xl p-4 mb-4 border border-green-500/30 bg-green-500/5">
                  <div class="flex items-center gap-2 mb-3">
                    <i class="fas fa-key text-green-400"></i>
                    <span class="font-semibold text-green-400">Akses Panel Server</span>
                  </div>
                  <div class="space-y-2 text-sm">
                    <div class="flex items-center justify-between">
                      <span class="text-gray-400">Login URL:</span>
                      <a href="<%= details.panelUrl %>" target="_blank" class="text-purple-400 hover:text-purple-300 flex items-center gap-1">
                        <%= details.panelUrl %> <i class="fas fa-external-link-alt text-xs"></i>
                      </a>
                    </div>
                    <div class="flex items-center justify-between">
                      <span class="text-gray-400">Username:</span>
                      <span class="font-mono text-white"><%= details.panelUsername %></span>
                    </div>
                    <div class="flex items-center justify-between">
                      <span class="text-gray-400">Password:</span>
                      <span class="font-mono text-white"><%= details.panelPassword %></span>
                    </div>
                    <% if (details.duration) { %>
                    <div class="flex items-center justify-between">
                      <span class="text-gray-400">Durasi:</span>
                      <span class="text-orange-400"><%= details.duration %></span>
                    </div>
                    <% } %>
                  </div>
                  <a href="<%= details.panelUrl %>" target="_blank" class="mt-3 w-full btn-primary py-2 rounded-lg text-sm font-medium flex items-center justify-center gap-2">
                    <i class="fas fa-external-link-alt"></i>
                    Login ke Panel
                  </a>
                </div>
                <% } %>
              <% } %>
              
              <% if (order.productType === 'product' && order.product && order.product.downloadLink) { %>
                <div class="mt-4">
                  <a href="<%= order.product.downloadLink %>" target="_blank" class="w-full btn-primary py-2.5 rounded-xl text-sm font-semibold flex items-center justify-center gap-2 bg-gradient-to-r from-blue-600 to-blue-400 hover:from-blue-500 hover:to-blue-300 shadow-lg shadow-blue-500/20 transition-all duration-300">
                    <i class="fas fa-download"></i>
                    Download Produk
                  </a>
                </div>
              <% } %>
              
              <div class="flex items-center justify-between pt-4 border-t border-white/10">
                <div class="text-sm text-gray-400">
                  <i class="fas fa-calendar mr-1"></i>
                  <%= new Date(order.createdAt).toLocaleString('id-ID', { timeZone: 'Asia/Jakarta' }) %>
                </div>
                <div class="font-bold text-lg gradient-text">
                  Rp <%= order.totalPrice.toLocaleString('id-ID') %>
                </div>
              </div>
            </div>
          <% }) %>
        </div>
      <% } else { %>
        <div class="glass-card rounded-3xl p-12 text-center">
          <i class="fas fa-shopping-bag text-6xl text-gray-600 mb-4"></i>
          <h3 class="text-xl font-semibold mb-2">Belum Ada Pesanan</h3>
          <p class="text-gray-400 mb-6">Anda belum memiliki pesanan. Mulai berbelanja sekarang!</p>
          <a href="/server" class="btn-primary px-6 py-3 rounded-xl inline-flex items-center gap-2">
            <i class="fas fa-server"></i>
            Beli Server
          </a>
        </div>
      <% } %>
    </div>
  </div>
</section>

<%- include('partials/footer') %>
